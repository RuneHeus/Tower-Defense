(#%require "Graphics.rkt")
(load "Constants.rkt")

(define (make-monster position)

  (define tile (make-tile 50 50 "../images/Monsters/monster1.png"))

  ((tile 'set-scale!) size-factor)

  ((tile 'set-x!) (+ (- (/ (* (tile 'get-w) size-factor) 2) (/ (tile 'get-w) 2)) (position 'get-x)))
  ((tile 'set-y!) (+ (- (/ (* (tile 'get-h) size-factor) 2) (/ (tile 'get-h) 2)) (position 'get-y)))
  
  (define increment-x 0)
  (define increment-y 0)

  (define (set-increment! x y)
    (set! increment-x x)
    (set! increment-y y))

  (define (endpoint?)
    ((position 'equal?) end-position))

  (define (set-next-position!)
    ((position 'change-coordinates!) (+ (position 'get-x) increment-x) (+ (position 'get-y) increment-y)))
  
  (define (dispatch mes)
    (cond ((eq? mes 'get-position) position)
          ((eq? mes 'get-tile) tile)
          ((eq? mes 'get-increment-x) increment-x)
          ((eq? mes 'get-increment-y) increment-y)
          ((eq? mes 'set-increment!) set-increment!)
          ((eq? mes 'endpoint?) endpoint?)
          ((eq? mes 'entity?) 'monster)
          ((eq? mes 'set-next-position!) (set-next-position!))))
  dispatch)